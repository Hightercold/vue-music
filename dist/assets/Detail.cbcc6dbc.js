import{Q as U,K as V,a1 as z,a7 as E,r as R,e as j,o as F,a8 as H,I as K,a9 as q,S as O,i as Q,j as l,k as _,l as t,x as k,q as h,D as c,F as N,C as T,z as f,W as d,t as P,m as y,U as W,V as Y}from"./index.af0fadc9.js";import{_ as B}from"./Loading.31f1f7b0.js";const G={name:"PlayListDetail",setup(){const{proxy:s}=V(),n=z(),p=E(),o=R({id:"",details:{},isShowDesc:!1,songList:[],collects:[],total:0,isLoading:!0}),D=j(()=>p.getters.isLogin),w=async i=>{o.isLoading=!0;const{data:a}=await s.$http.playlistdetail(i);if(a.code!==200)return s.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");if(o.details=a.playlist,D.value){const $=a.playlist.trackIds;g($)}else o.songList=s.$utils.formatSongs(a.playlist.tracks,a.privileges),o.total=o.songList.length,o.isLoading=!1},g=async i=>{const a=[];let v=[];for(let r=0;r<i.length;r+=500)a.push(i.slice(r,r+500));for(let r=0;r<a.length;r++){const I=[];a[r].map(M=>{I.push(M.id)}),o.isLoading=!0;const{data:A}=await s.$http.songDetail({ids:I.join(","),timestamp:new Date().valueOf()+r});v=v.concat(s.$utils.formatSongs(A.songs,A.privileges))}o.songList=v,o.total=v.length,o.isLoading=!1},m=()=>{o.details.description.length>120&&(o.isShowDesc=!o.isShowDesc)},L=()=>{p.dispatch("loginSuc",!0)},S=async i=>{const{data:a}=await s.$http.playlistSCollect(i);if(a.code!==200)return s.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");o.collects=a.subscribers},e=()=>{p.dispatch("playAll",{list:o.songList}),p.commit("SET_PLAYLISTTIPS",!0)},b=async i=>{const{data:a}=await s.$http.subPlayList({id:i.id,t:i.subscribed?2:1});if(a.code!==200)return s.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");o.details.subscribed=!o.details.subscribed};F(()=>{o.id=n.query.id,C(o.id)});const C=i=>{w({id:i,s:8}),S({id:i,limit:8})};return H(i=>{o.songList=[],o.total=0,o.id=i.query.id,C(o.id)}),{...K(o),playAllSongs:e,subPlayList:b,loginDialog:L,showAllDesc:m}},components:{Loading:B,SongList:q}},u=s=>(W("data-v-ab4bdfa2"),s=s(),Y(),s),J={class:"detail"},X={class:"detail-container"},Z={class:"detail-main"},x={class:"cover"},ss={class:"cover-img"},ts=u(()=>t("div",{slot:"placeholder",class:"image-slot"},[t("i",{class:"iconfont icon-placeholder"})],-1)),os={class:"cover-info"},es={class:"cover-header"},is={class:"cover-title"},as={class:"cover-collect-author"},ls=u(()=>t("div",{slot:"placeholder",class:"image-slot"},[t("i",{class:"iconfont icon-placeholder"})],-1)),ns={class:"cover-author-tags"},cs={key:0,class:"cover-author"},rs=u(()=>t("div",{slot:"placeholder",class:"image-slot"},[t("i",{class:"iconfont icon-placeholder"})],-1)),ds={class:"cover-name"},us={class:"cover-date"},_s={key:1,class:"cover-tags"},ps={class:"cover-digital"},gs={class:"cover-playCount"},hs=u(()=>t("i",{class:"iconfont icon-playnum"},null,-1)),ms={class:"cover-collect"},vs=u(()=>t("i",{class:"iconfont icon-collect"},null,-1)),fs={class:"cover-comment"},ys=u(()=>t("i",{class:"iconfont icon-comment"},null,-1)),Ls={class:"cover-desc"},Ss=u(()=>t("i",{class:"iconfont icon-closed"},null,-1)),bs=[Ss],ks=["innerHTML"],Ds={key:0,class:"cover-desc-all"},ws={class:"song-main"},Cs={class:"song-header"},$s=u(()=>t("i",{class:"iconfont icon-audio-play"},null,-1));function Is(s,n,p,o,D,w){const g=O,m=Q("router-link"),L=B,S=q;return l(),_("div",J,[t("div",X,[t("div",Z,[t("div",x,[t("div",ss,[k(g,{src:s.details.coverImgUrl},{default:h(()=>[ts]),_:1},8,["src"])]),t("div",os,[t("div",es,[t("div",is,c(s.details.name),1),t("div",as,[(l(!0),_(N,null,T(s.collects,e=>(l(),y(m,{class:"collect-author",to:{path:"/singer",query:{id:e.userId}},key:e.userId},{default:h(()=>[k(g,{src:e.avatarUrl},{default:h(()=>[ls]),_:2},1032,["src"])]),_:2},1032,["to"]))),128))])]),t("div",ns,[s.details.creator?(l(),_("div",cs,[k(g,{src:s.details.creator.avatarUrl,class:"cover-avatar"},{default:h(()=>[rs]),_:1},8,["src"]),t("div",ds,c(s.details.creator.nickname),1),t("div",us,c(s.$utils.formartDate(s.details.createTime,"yyyy-MM-dd")),1)])):f("",!0),s.details.tags?(l(),_("div",_s,[(l(!0),_(N,null,T(s.details.tags,(e,b)=>(l(),y(m,{to:{path:"/playlist",query:{cat:e}},class:"tag",key:b},{default:h(()=>[d("#"+c(e),1)]),_:2},1032,["to"]))),128))])):f("",!0)]),t("div",ps,[t("span",gs,[hs,d(" "+c(s.$utils.formartNum(s.details.playCount))+"\u6B21",1)]),t("span",ms,[vs,d(" "+c(s.$utils.formartNum(s.details.subscribedCount)),1)]),t("span",fs,[ys,d(" "+c(s.$utils.formartNum(s.details.commentCount)),1)])]),t("div",Ls,[t("h5",null,[d("\u6B4C\u5355\u7B80\u4ECB"),s.isShowDesc?(l(),_("em",{key:0,class:"desc-close",onClick:n[0]||(n[0]=e=>s.isShowDesc=!1)},bs)):f("",!0)]),t("p",{innerHTML:s.details.description,onClick:n[1]||(n[1]=(...e)=>o.showAllDesc&&o.showAllDesc(...e))},null,8,ks),s.isShowDesc?(l(),_("pre",Ds,"                                "+c(s.details.description)+`
                            `,1)):f("",!0)])])]),t("div",ws,[t("div",Cs,[t("h4",null,[d("\u6B4C\u66F2\u5217\u8868 "),t("em",null,c(s.total+"\u9996\u6B4C"),1)]),t("span",{class:"play-all",onClick:n[2]||(n[2]=(...e)=>o.playAllSongs&&o.playAllSongs(...e))},[$s,d(" \u64AD\u653E\u5168\u90E8")]),t("span",{class:P(["collect",s.details.subscribed?"active":""]),onClick:n[3]||(n[3]=e=>o.subPlayList(s.details))},[t("i",{class:P(["iconfont","icon-collect"+(s.details.subscribed?"-active":"")])},null,2),d(" "+c(s.details.subscribed?"\u5DF2\u6536\u85CF":"\u6536\u85CF"),1)],2)]),s.isLoading?(l(),y(L,{key:0})):(l(),y(S,{key:1,songList:s.songList,stripe:!0},null,8,["songList"]))])])])])}var Ts=U(G,[["render",Is],["__scopeId","data-v-ab4bdfa2"]]);export{Ts as default};
